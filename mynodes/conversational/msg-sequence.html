<script type="text/javascript">
    RED.nodes.registerType('msg-sequence',{
        category: 'Sequence',
        color: '#FFCC66',
        defaults: {
            name: {value:""},
            outputs: {value:1},
        },
        inputs:1,
        outputs:3,
        icon: "serial.png",
        label: function() {
            return this.name||"msg-sequence";
        },
        outputLabels: function(index) {
            if(index != this.outputs-1)
            {
                return "run "+(index+1);
            }else{
                return "Complete";
            }
        },
        oneditprepare: function() {
            var that = this;
            // https://nodered.org/docs/creating-nodes/appearance
            // nicked from RED/CORE/function js.
            $( "#node-input-outputs" ).spinner({
                min:1,
                change: function(event, ui) {
                    var value = this.value;
                    if (!value.match(/^\d+$/)) { value = 1;  }
                    else if (value < this.min) { value = this.min; }
                    if (value !== this.value) { $(this).spinner("value", value); }
                }
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="msg-sequence">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-outputs"><i class="fa fa-random"></i> <span data-i18n="function.label.outputs"></span></label>
        <input id="node-input-outputs" style="width: 60px;" value="1">
    </div>
</script>

<script type="text/x-red" data-help-name="msg-sequence">
    <p>
    A simple node that allows you to stack nodes into a message before continuing.</p>
   <p> Won't work well with async nodes as the msg object is passed to each output port in sqeuence. There is no callback trigger to make the loop wait. Use another node pattern.</p>

</script>